//
// Shellcode Tester 
//
// gcc -ggdb -m64 -O3 -fno-stack-protector -o pic-shellcode pic-shellcode.c
//

#include <stdio.h>

unsigned char shellcode[] = \
"\x53\x48\xb8\x2f\x75\x73\x72\x2f\x62\x69\x6e\x48\x83\xec\x40\x48\x89\x44\x24\x11\xb8\x6c\x63\x00\x00\x48\x8d\x5c\x24\x11\x66\x89\x44\x24\x1d\x48\xb8\x44\x49\x53\x50\x4c\x41\x59\x3d\xc7\x44\x24\x19\x2f\x78\x63\x61\x48\x89\x44\x24\x04\x48\x8d\x44\x24\x04\xc6\x44\x24\x1f\x00\xc7\x44\x24\x0c\x3a\x30\x2e\x30\xc6\x44\x24\x10\x00\x48\x89\x44\x24\x20\x48\xc7\x44\x24\x28\x00\x00\x00\x00\x48\x89\x5c\x24\x30\x48\xc7\x44\x24\x38\x00\x00\x00\x00\xb8\x39\x00\x00\x00\x0f\x05\x85\xc0\x75\x14\x48\x8d\x54\x24\x20\x48\x8d\x74\x24\x30\x48\x89\xdf\xb8\x3b\x00\x00\x00\x0f\x05\x48\x83\xc4\x40\x5b\xc3";

void main()
{
	printf("Shellcode: %p\n", &shellcode);
	printf("Size of shellcode: %ld bytes\n", sizeof(shellcode));
	printf("Press any key to execute...\n");

	getchar();

    int (*ret)() = (int(*)())shellcode;
    ret();
}
